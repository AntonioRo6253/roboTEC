<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carrera Robots (Dise√±o Original + Juego Real)</title>

<style>
body{
  background:#061826;
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:Arial;
  color:white;
}

#juego{
  width:1200px;
  height:650px;
  display:flex;
  background:#0b2c3f;
  border-radius:18px;
  box-shadow:0 0 25px black;
  padding:12px;
}

/* ===== PISTA ===== */
#pista{
  width:65%;
  height:100%;
  background:#082b3a;
  border-radius:14px;
  padding:15px;
  position:relative;
  display:flex;
  flex-direction:column;
  justify-content:space-around;
}

.lane{
  background:#062233;
  height:170px;
  border-radius:12px;
  position:relative;
}

/* ROBOT */
.robot{
  width:70px;
  height:70px;
  background:#69d2ff;
  border-radius:12px;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:30px;
  position:absolute;
  left:16px;
  top:50%;
  transform:translateY(-50%);
  transition:0.25s;
}
#r2{background:#8aff9d;}

/* META */
#meta{
  position:absolute;
  top:20px;
  bottom:20px;
  right:18px;
  width:10px;
  background:red;
  border-radius:5px;
}

/* OBJETOS */
.moneda{
  width:26px;
  height:26px;
  background:gold;
  border-radius:50%;
  position:absolute;
}

.obs{
  width:60px;
  height:60px;
  background:#e53935;
  position:absolute;
  border-radius:12px;
}

/* PANEL */
#panel{
  width:35%;
  background:#051d2a;
  border-radius:14px;
  padding:15px;
  margin-left:12px;
  display:flex;
  flex-direction:column;
}

button{
  padding:12px;
  margin:4px 0;
  font-weight:bold;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

.avanzar{background:#ffd166;}
.turbo{background:#7b61ff;color:white;}
.retro{background:#e63946;color:white;}
.arriba{background:#4dabf7;}
.abajo{background:#4dabf7;}
.esperar{background:#999;}

#secuencia{
  background:black;
  min-height:60px;
  margin:10px 0;
  padding:6px;
}

#puntos{
  margin-top:auto;
  display:flex;
  justify-content:space-around;
}
</style>
</head>

<body>

<div id="juego">
  <div id="pista">
    <div id="meta"></div>

    <div class="lane" id="lane1">
      <div class="robot" id="r1">ü§ñ</div>
      <div class="moneda" style="left:430px; top:70px" data-used="0"></div>
      <div class="obs" style="left:650px; top:50px"></div>
    </div>

    <div class="lane" id="lane2">
      <div class="robot" id="r2">ü§ñ</div>
      <div class="moneda" style="left:480px; top:70px" data-used="0"></div>
      <div class="obs" style="left:700px; top:50px"></div>
    </div>
  </div>

  <div id="panel">
    <h2>Carrera Robots</h2>
    <div id="turno">Turno: Jugador 1</div>

    <button class="avanzar" onclick="add('right')">‚û° DERECHA</button>
    <button class="retro" onclick="add('left')">‚¨Ö IZQUIERDA</button>
    <button class="turbo" onclick="add('turbo')">‚ö° TURBO</button>
    <button class="arriba" onclick="add('up')">‚¨Ü ARRIBA</button>
    <button class="abajo" onclick="add('down')">‚¨á ABAJO</button>
    <button class="esperar" onclick="add('wait')">üßç ESPERAR</button>

    <div id="secuencia"></div>
    <button onclick="run()">‚ñ∂ EJECUTAR</button>
    <button onclick="clearSeq()">üóë BORRAR</button>

    <div id="puntos">
      <div>J1: <span id="p1">0</span></div>
      <div>J2: <span id="p2">0</span></div>
    </div>
  </div>
</div>

<script>
let turno=1, seq=[];
let pos = {
  r1:{x:16,y:85},
  r2:{x:16,y:255}
};
let score={r1:0,r2:0};

function add(cmd){
  seq.push(cmd);
  document.getElementById("secuencia").innerText = seq.join(" , ");
}

function clearSeq(){
  seq=[];
  document.getElementById("secuencia").innerText="";
}

async function run(){
  let id = turno===1?'r1':'r2';
  let robot = document.getElementById(id);
  let lane = document.getElementById(turno===1?'lane1':'lane2');

  for(let cmd of seq){
    await sleep(300);
    if(cmd=='right') pos[id].x+=50;
    if(cmd=='left') pos[id].x-=50;
    if(cmd=='turbo') pos[id].x+=90;
    if(cmd=='up') pos[id].y-=30;
    if(cmd=='down') pos[id].y+=30;

    let maxW = lane.clientWidth-80;
    let maxH = lane.clientHeight-80;

    pos[id].x=Math.max(0,Math.min(maxW,pos[id].x));
    pos[id].y=Math.max(10,Math.min(maxH,pos[id].y));

    robot.style.left=pos[id].x+"px";
    robot.style.top=pos[id].y+"px";

    detectarColisiones(id);

    if(pos[id].x > lane.clientWidth-100){
      ganar(turno);
      return;
    }
  }

  seq=[];
  document.getElementById("secuencia").innerText="";
  turno=turno===1?2:1;
  document.getElementById("turno").innerText="Turno: Jugador "+turno;
}

function detectarColisiones(id){
  let robotR = document.getElementById(id).getBoundingClientRect();

  // monedas
  document.querySelectorAll(".moneda").forEach(m=>{
    if(!m.dataset.used && choca(robotR,m.getBoundingClientRect())){
      m.dataset.used=1;
      m.style.display="none";
      score[id]+=10;
      actualizarPuntos();
    }
  });

  // obstaculos
  document.querySelectorAll(".obs").forEach(o=>{
    if(choca(robotR,o.getBoundingClientRect())){
      pos[id].x -= 60; // castigo
    }
  });
}

function choca(a,b){
  return !(a.right<b.left||a.left>b.right||a.bottom<b.top||a.top>b.bottom);
}

function actualizarPuntos(){
  document.getElementById("p1").innerText=score.r1;
  document.getElementById("p2").innerText=score.r2;
}

function ganar(j){
  alert(" GANA JUGADOR "+j);
  location.reload();
}

function sleep(ms){return new Promise(r=>setTimeout(r,ms));}
</script>

</body>
</html>
